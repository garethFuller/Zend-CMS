<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!-- Consider adding an manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<head>
    <meta charset="utf-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <?php 
        $this->headLink()//->prependStylesheet('/cms/assets/css/mobile/jiggly.min.css')
                         //->prependStylesheet('http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css')
                         ->prependStylesheet("/cms/assets/css/style.css");

        $this->headScript()//->prependFile("http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js")
                           ->prependFile("http://code.jquery.com/jquery.min.js");
                           //->prependFile("/cms/assets/js/libs/modernizr-2.0.6.min.js");
        
        // Check if the current controller is content, if it is include the ckeditor shizzle
        $currentController = Zend_Controller_Front::getInstance()->getRequest()->getControllerName();
        $currentAction = Zend_Controller_Front::getInstance()->getRequest()->getActionName();
        
        if ($currentController == 'content'){

            $this->headScript()->appendFile('/cms/assets/ckeditor/ckeditor.js')
                                ->appendFile('/cms/assets/ckeditor/config.js')
                                ->appendFile('/cms/assets/ckeditor/lang/en-gb.js');
            
        }
        
        if ($currentController == 'index' && $currentAction == 'index'){
            $this->headScript()->appendFile('http://code.jquery.com/ui/1.8.17/jquery-ui.min.js');
            
            $this->headScript()->appendFile('/cms/assets/js/libs/nested-sortables.js');
            $this->headScript()->appendFile('/cms/assets/js/libs/touchpunch.js');
            $this->headScript()->appendFile('/cms/assets/js/desktop/script.js');
        }
        
        
        
        echo $this->headLink();
        echo $this->headScript();
    ?>
    
    <title>Jiggly CMS<?php if($this->pageTitle){ echo ' | '.$this->pageTitle; }?></title>
    
    <!--[if lt IE 7 ]>
        <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
        <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
    <![endif]-->
    
    <meta name="description" content="Jiggly CMS, content management for the people!">
    <meta name="author" content="Gareth Fuller">

    <!-- Mobile viewport optimized: j.mp/bplateviewport -->
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
    
</head>
<body>
    <div data-role="page" data-theme="a" id="page-wrapper">

        <?php echo $this->render('header.phtml') ?>


        <div id="content" data-role="content">

            <?php if (isset($this->messages[0]) && ($this->messages[0] != '')): ?>
                <div id="flash-mssg-container">
                    <div class="ui-state-highlight ui-corner-all"> 
                            <p><span class="ui-icon ui-icon-info"></span>
                            <?php echo $this->messages[0]; ?></p>
                    </div>
                </div>
                <div class="clear-both"></div>
            <?php endif ?>

            <?php echo $this->layout()->content; ?>
        </div>

        <div class="clear-both"></div>
        <?php echo $this->render('footer.phtml') ?>
    </div>
</body>
